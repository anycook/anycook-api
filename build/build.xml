<?xml version = '1.0' encoding = 'utf-8'?> <!DOCTYPE project>

<project name="anycook-graph" default="dist" basedir="..">
	
	<!-- properties -->
	<loadproperties srcFile="${basedir}/../../code-generic/code-build/anycook.properties" prefix="anycook"/>
	<loadproperties srcFile="${basedir}/../../code-generic/code-build/thirdparty.properties" prefix="thirdparty"/>
	
	<property name="keeponly" value="de.anycook.**" />
	<property name="tomcat.lib" location="../../tomcat7/lib" />
	<property name="project.webxml" location="WebContent/WEB-INF/web.xml"/>

	<property name="build.sysclasspath" value="last" />
	<!--<ant antfile="${anycook.build}" dir="${anycook}"/>-->

	<path id="sources">
	        <pathelement location="src" />
	</path>
	<path id="libraries">
		<fileset dir="${tomcat.lib}" includes="*.jar"/>
		<fileset dir="${thirdparty.google.guava}" includes="guava-13.0.1.jar"/>
		<fileset dir="${thirdparty.log4j}" includes="*.jar"/>
		<fileset dir="${thirdparty.commons.lang3}" includes="*.jar"/>
		<fileset dir="${thirdparty.jersey}/lib" includes="*.jar"/>
		<fileset dir="${thirdparty.jersey.contrib}" includes="oauth*.jar"/>
	</path>
	
	<path id="dependencies">
		<pathelement location="${anycook.main}" />
		<pathelement location="${anycook.mongodb}" />		
		<pathelement location="${anycook.messages}" />
		<pathelement location="${anycook.mysqldb}" />
		<pathelement location="${anycook.news}" />
		<pathelement location="${anycook.search}" />
		<pathelement location="${anycook.upload}" />
		<pathelement location="${anycook.user}" />
		<pathelement location="${anycook.utils}" />
		<pathelement location="${anycook.discussion}" />
	</path>
	
	<!-- upload war file to anycook.de -->
	<target name="upload" depends="dist">
		  <scp file="build/ROOT.war" todir="${user}@anycook.de:/usr/share/apache-tomcat-7.0.34/webapps/" keyfile="../../../../../.ssh/id_rsa" />
	</target>
	
	<!-- distribution -->
	<target name="dist" depends="jar">
		<war destfile="build/ROOT.war" webxml="${project.webxml}">
            <lib dir="build">
                   <include name="anycook-graph.jar" />
            </lib>
			<lib dir="${thirdparty.log4j}">
				<include name="*.jar" />
			</lib>
			<lib dir="${thirdparty.jersey}/lib">
				<include name="*.jar" />
			</lib>
			<lib dir="${thirdparty.mongo}">
				<include name="*.jar" />
			</lib>
			<lib dir="${thirdparty.fastutil}">
				<include name="*.jar" />
			</lib>
			<lib dir="${thirdparty.snowball}">
				<include name="*.jar" />
			</lib>
			<lib dir="${thirdparty.commons.lang3}">
				<include name="commons-lang3-3.1.jar" />
			</lib>
			<lib dir="${thirdparty.commons.math3}">
				<include name="commons-math3-3.0.jar" />
			</lib>
			<lib dir="${thirdparty.commons.dbcp}">
				<include name="commons-dbcp-1.4.jar" />
			</lib>
			<lib dir="${thirdparty.google.guava}">
				<include name="guava-13.0.1.jar" />
			</lib>
			<lib dir="${thirdparty.commons.pool}">
				<include name="commons-pool-1.6.jar" />
			</lib>
			<lib dir="${thirdparty.mysql.jdbc}">
				<include name="mysql-connector-java-5.1.21-bin.jar" />
			</lib>
			<lib dir="${thirdparty.commons.logging}">
				<include name="commons-logging-1.1.1.jar" />
			</lib>
		</war>
		<!-- <delete dir="${project.build}" /> -->
	</target>

	<import file="${basedir}/../../code-generic/code-build/build-master.xml" />
</project>
